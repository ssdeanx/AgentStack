@import 'tailwindcss';
@import 'tw-animate-css';
@source "../node_modules/streamdown/dist/index.js";
/* Tailwind CSS v4 Custom Variants */
@custom-variant dark (&:is(.dark *));
@custom-variant starting (&:is(:popover-open, :modal, [data-state="open"]):starting-style);
@custom-variant inert (&:is([inert], [inert] *));
@custom-variant open (&:is([data-state="open"], :popover-open, dialog[open]));
@custom-variant closed (&:is([data-state="closed"]));

/* CSS @property for Animatable Custom Properties */
@property --gradient-angle {
    syntax: '<angle>';
    initial-value: 0deg;
    inherits: false;
}

@property --gradient-position {
    syntax: '<percentage>';
    initial-value: 0%;
    inherits: false;
}

@property --blur-amount {
    syntax: '<length>';
    initial-value: 0px;
    inherits: false;
}

@property --scale-factor {
    syntax: '<number>';
    initial-value: 1;
    inherits: false;
}

@theme inline {
    /* Border Radius Tokens */
    --radius-sm: calc(var(--radius) - 4px);
    --radius-md: calc(var(--radius) - 2px);
    --radius-lg: var(--radius);
    --radius-xl: calc(var(--radius) + 4px);

    /* Container Query Breakpoints (v4 built-in) */
    --container-3xs: 16rem;
    --container-2xs: 18rem;
    --container-xs: 20rem;
    --container-sm: 24rem;
    --container-md: 28rem;
    --container-lg: 32rem;
    --container-xl: 36rem;
    --container-2xl: 42rem;
    --container-3xl: 48rem;

    /* 3D Transform & Perspective Tokens */
    --perspective-none: none;
    --perspective-dramatic: 100px;
    --perspective-near: 300px;
    --perspective-normal: 500px;
    --perspective-midrange: 800px;
    --perspective-distant: 1200px;
    --perspective-default: 1000px;

    /* Color Tokens (oklch) */
    --color-background: var(--background);
    --color-foreground: var(--foreground);
    --color-card: var(--card);
    --color-card-foreground: var(--card-foreground);
    --color-popover: var(--popover);
    --color-popover-foreground: var(--popover-foreground);
    --color-primary: var(--primary);
    --color-primary-foreground: var(--primary-foreground);
    --color-secondary: var(--secondary);
    --color-secondary-foreground: var(--secondary-foreground);
    --color-muted: var(--muted);
    --color-muted-foreground: var(--muted-foreground);
    --color-accent: var(--accent);
    --color-accent-foreground: var(--accent-foreground);
    --color-destructive: var(--destructive);
    --color-border: var(--border);
    --color-input: var(--input);
    --color-ring: var(--ring);
    --color-chart-1: var(--chart-1);
    --color-chart-2: var(--chart-2);
    --color-chart-3: var(--chart-3);
    --color-chart-4: var(--chart-4);
    --color-chart-5: var(--chart-5);
    --color-sidebar: var(--sidebar);
    --color-sidebar-foreground: var(--sidebar-foreground);
    --color-sidebar-primary: var(--sidebar-primary);
    --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
    --color-sidebar-accent: var(--sidebar-accent);
    --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
    --color-sidebar-border: var(--sidebar-border);
    --color-sidebar-ring: var(--sidebar-ring);

    /* Animation Timing Functions */
    --ease-spring: cubic-bezier(0.175, 0.885, 0.32, 1.275);
    --ease-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
    --ease-smooth: cubic-bezier(0.4, 0, 0.2, 1);

    /* Shadow Tokens with color-mix */
    --shadow-color: oklch(0 0 0 / 10%);
    --shadow-color-dark: oklch(0 0 0 / 25%);

    /* Glassmorphism Tokens */
    --glass-opacity: 0.4;
    --glass-blur: 12px;
    --glass-border: oklch(1 0 0 / 10%);
}

:root {
    --radius: 0.5rem;
    --background: oklch(1 0 0);
    --foreground: oklch(0.129 0.042 264.695);
    --card: oklch(1 0 0);
    --card-foreground: oklch(0.129 0.042 264.695);
    --popover: oklch(1 0 0);
    --popover-foreground: oklch(0.129 0.042 264.695);
    --primary: oklch(0.129 0.042 264.695);
    --primary-foreground: oklch(0.985 0 0);
    --secondary: oklch(0.967 0.001 286.375);
    --secondary-foreground: oklch(0.21 0.006 285.885);
    --muted: oklch(0.967 0.001 286.375);
    --muted-foreground: oklch(0.552 0.016 285.938);
    --accent: oklch(0.967 0.001 286.375);
    --accent-foreground: oklch(0.21 0.006 285.885);
    --destructive: oklch(0.577 0.245 27.325);
    --border: oklch(0.92 0.004 286.32);
    --input: oklch(0.92 0.004 286.32);
    --ring: oklch(0.129 0.042 264.695);
    --chart-1: oklch(0.646 0.222 41.116);
    --chart-2: oklch(0.6 0.118 184.704);
    --chart-3: oklch(0.398 0.07 227.392);
    --chart-4: oklch(0.828 0.189 84.429);
    --chart-5: oklch(0.769 0.188 70.08);
    --sidebar: oklch(0.985 0 0);
    --sidebar-foreground: oklch(0.129 0.042 264.695);
    --sidebar-primary: oklch(0.129 0.042 264.695);
    --sidebar-primary-foreground: oklch(0.985 0 0);
    --sidebar-accent: oklch(0.967 0.001 286.375);
    --sidebar-accent-foreground: oklch(0.21 0.006 285.885);
    --sidebar-border: oklch(0.92 0.004 286.32);
    --sidebar-ring: oklch(0.129 0.042 264.695);

    /* Advanced OKLCH Semantic Colors */
    --glow-primary: oklch(0.6 0.2 260 / 50%);
    --surface-glass: oklch(1 0 0 / var(--glass-opacity));

    /* Liquid Glass Tokens */
    --liquid-glass-opacity: 0.15;
    --liquid-glass-blur: 24px;
    --liquid-glass-border: oklch(1 0 0 / 20%);
    
    /* Ambient Animation Tokens */
    --ambient-pulse-duration: 6s;

    /* Bento Grid Tokens */
    --bento-gap: 1rem;
    --bento-radius: 1.5rem;
}

.dark {
    --background: oklch(0.05 0 0); /* Obsidian Dark */
    --foreground: oklch(0.985 0 0);
    --card: oklch(0.1 0 0); /* Slightly lighter for cards */
    --card-foreground: oklch(0.985 0 0);
    --popover: oklch(0.05 0 0);
    --popover-foreground: oklch(0.985 0 0);
    --primary: oklch(0.985 0 0);
    --primary-foreground: oklch(0.129 0.042 264.695);
    --secondary: oklch(0.15 0 0);
    --secondary-foreground: oklch(0.985 0 0);
    --muted: oklch(0.15 0 0);
    --muted-foreground: oklch(0.65 0 0);
    --accent: oklch(0.15 0 0);
    --accent-foreground: oklch(0.985 0 0);
    --destructive: oklch(0.704 0.191 22.216);
    --border: oklch(0.2 0 0); /* Subtle borders */
    --input: oklch(0.2 0 0);
    --ring: oklch(0.8 0 0);
    --chart-1: oklch(0.488 0.243 264.376);
    --chart-2: oklch(0.696 0.17 162.48);
    --chart-3: oklch(0.769 0.188 70.08);
    --chart-4: oklch(0.627 0.265 303.9);
    --chart-5: oklch(0.645 0.246 16.439);
    --sidebar: oklch(0.05 0 0);
    --sidebar-foreground: oklch(0.985 0 0);
    --sidebar-primary: oklch(0.488 0.243 264.376);
    --sidebar-primary-foreground: oklch(0.985 0 0);
    --sidebar-accent: oklch(0.15 0 0);
    --sidebar-accent-foreground: oklch(0.985 0 0);
    --sidebar-border: oklch(0.2 0 0);
    --sidebar-ring: oklch(0.8 0 0);

    /* Dark Mode Glass */
    --surface-glass: oklch(0.1 0 0 / var(--glass-opacity));
    --glass-border: oklch(1 0 0 / 5%);
    --glow-primary: oklch(0.7 0.2 260 / 30%);
}

@layer base {
    * {
        @apply border-border outline-ring/50;
    }
    body {
        @apply bg-background text-foreground;
    }
}

/* Tailwind CSS v4 - Transition Discrete Support */
@layer utilities {
    .transition-discrete {
        transition-behavior: allow-discrete;
    }

    .transition-normal {
        transition-behavior: normal;
    }

    /* 3D Transform Utilities */
    .perspective-none {
        perspective: none;
    }

    .perspective-dramatic {
        perspective: var(--perspective-dramatic);
    }

    .perspective-near {
        perspective: var(--perspective-near);
    }

    .perspective {
        perspective: var(--perspective-default);
    }

    .perspective-distant {
        perspective: var(--perspective-distant);
    }

    .preserve-3d {
        transform-style: preserve-3d;
    }

    .flat {
        transform-style: flat;
    }

    .backface-visible {
        backface-visibility: visible;
    }

    .backface-hidden {
        backface-visibility: hidden;
    }

    /* Rotate 3D Utilities */
    .rotate-x-0 {
        transform: rotateX(0deg);
    }
    .rotate-x-1 {
        transform: rotateX(1deg);
    }
    .rotate-x-2 {
        transform: rotateX(2deg);
    }
    .rotate-x-3 {
        transform: rotateX(3deg);
    }
    .rotate-x-6 {
        transform: rotateX(6deg);
    }
    .rotate-x-12 {
        transform: rotateX(12deg);
    }
    .-rotate-x-1 {
        transform: rotateX(-1deg);
    }
    .-rotate-x-2 {
        transform: rotateX(-2deg);
    }
    .-rotate-x-3 {
        transform: rotateX(-3deg);
    }
    .-rotate-x-6 {
        transform: rotateX(-6deg);
    }

    .rotate-y-0 {
        transform: rotateY(0deg);
    }
    .rotate-y-1 {
        transform: rotateY(1deg);
    }
    .rotate-y-2 {
        transform: rotateY(2deg);
    }
    .rotate-y-3 {
        transform: rotateY(3deg);
    }
    .rotate-y-6 {
        transform: rotateY(6deg);
    }
    .rotate-y-12 {
        transform: rotateY(12deg);
    }
    .-rotate-y-1 {
        transform: rotateY(-1deg);
    }
    .-rotate-y-2 {
        transform: rotateY(-2deg);
    }
    .-rotate-y-3 {
        transform: rotateY(-3deg);
    }
    .-rotate-y-6 {
        transform: rotateY(-6deg);
    }

    /* Translate Z Utilities */
    .translate-z-0 {
        transform: translateZ(0px);
    }
    .translate-z-1 {
        transform: translateZ(0.25rem);
    }
    .translate-z-2 {
        transform: translateZ(0.5rem);
    }
    .translate-z-4 {
        transform: translateZ(1rem);
    }
    .translate-z-8 {
        transform: translateZ(2rem);
    }
    .-translate-z-1 {
        transform: translateZ(-0.25rem);
    }
    .-translate-z-2 {
        transform: translateZ(-0.5rem);
    }

    /* Gradient Angle Animation */
    .animate-gradient-rotate {
        animation: gradient-rotate 3s linear infinite;
    }

    /* Color Scheme Utilities */
    .color-scheme-light {
        color-scheme: light;
    }

    .color-scheme-dark {
        color-scheme: dark;
    }

    .color-scheme-auto {
        color-scheme: light dark;
    }

    /* Glassmorphism Utility */
    .glass {
        background: var(--surface-glass);
        backdrop-filter: none;
        border: 1px solid var(--glass-border);
    }

    /* Glow Utility */
    .glow-primary {
        box-shadow: 0 0 20px var(--glow-primary);
    }

    /* Liquid Glass Utility */
    .liquid-glass {
        background: color-mix(in oklch, var(--surface-glass), transparent 10%);
        backdrop-filter: none;
        border: 1px solid var(--liquid-glass-border);
        box-shadow: 
            0 8px 32px -1px oklch(0 0 0 / 15%),
            inset 0 0 0 1px var(--liquid-glass-border);
    }

    /* Ambient Pulse Animation */
    .animate-ambient-pulse {
        animation: ambient-pulse var(--ambient-pulse-duration) ease-in-out infinite;
    }

    @keyframes ambient-pulse {
        0%, 100% { 
            opacity: 0.9; 
            filter: brightness(1) saturate(1);
            transform: scale(1);
        }
        50% { 
            opacity: 1; 
            filter: brightness(1.1) saturate(1.2) drop-shadow(0 0 15px var(--glow-primary));
            transform: scale(1.01);
        }
    }

    /* Kinetic Typography */
    .kinetic-text {
        transition: font-variation-settings 0.3s ease;
    }
    .kinetic-text:hover {
        font-variation-settings: "wght" 700, "wdth" 120;
    }

    /* Scroll-driven Reveal */
    .reveal-on-scroll {
        view-timeline-name: --reveal;
        view-timeline-axis: block;
        animation-name: reveal;
        animation-fill-mode: both;
        animation-timeline: --reveal;
        animation-range: entry 10% cover 30%;
    }

    @keyframes reveal {
        from {
            opacity: 0;
            transform: translateY(20px) scale(0.95);
        }
        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    /* Bento Grid Utility */
    .bento-grid {
        display: grid;
        gap: var(--bento-gap);
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        grid-auto-rows: minmax(160px, auto);
    }

    .bento-item {
        position: relative;
        overflow: hidden;
        border-radius: var(--bento-radius);
        border: 1px solid var(--border);
        background: var(--card);
        padding: 1.5rem;
        transition: all 0.5s var(--ease-smooth);
        background: var(--surface-glass);
        backdrop-filter: none;
    }

    .bento-item:hover {
        transform: translateY(-0.25rem);
        box-shadow: var(--shadow-2xl);
        border-color: var(--primary);
    }

    /* Magnetic Interaction (CSS-only approximation) */
    .magnetic {
        transition: transform 0.3s cubic-bezier(0.23, 1, 0.32, 1);
    }
    .magnetic:hover {
        transform: scale(1.05) translateZ(20px);
    }

    /* Liquid Progress Animation */
    .liquid-progress {
        position: relative;
        overflow: hidden;
    }
    .liquid-progress::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 200%;
        background: linear-gradient(
            90deg,
            transparent,
            oklch(var(--primary) / 20%),
            transparent
        );
        animation: liquid-flow 2s infinite linear;
    }

    @keyframes liquid-flow {
        from { transform: translateX(-100%); }
        to { transform: translateX(0); }
    }

    /* Focus Mode Utility */
    .focus-mode-active .hide-on-focus {
        opacity: 0;
        pointer-events: none;
        transform: translateY(-10px);
        transition: all 0.5s ease;
    }

    /* Spatial Depth Utility */
    .spatial-depth {
        transform: translateZ(50px);
        box-shadow: 
            0 20px 50px -10px oklch(0 0 0 / 30%),
            0 10px 20px -5px oklch(0 0 0 / 20%);
        transition: transform 0.5s var(--ease-spring);
    }
    .spatial-depth:hover {
        transform: translateZ(70px) translateY(-5px);
    }

    /* View Transitions (CSS-only approximation for SPA) */
    .view-transition-fade {
        view-transition-name: main-content;
    }

    ::view-transition-old(main-content) {
        animation: 0.3s ease-out both fade-out;
    }
    ::view-transition-new(main-content) {
        animation: 0.5s var(--ease-spring) both fade-in;
    }

    @keyframes fade-out {
        from { opacity: 1; transform: scale(1); }
        to { opacity: 0; transform: scale(0.98); }
    }
    @keyframes fade-in {
        from { opacity: 0; transform: scale(1.02); }
        to { opacity: 1; transform: scale(1); }
    }

    /* Noise Texture Overlay */
    .noise {
        position: relative;
    }

    .noise::before {
        content: '';
        position: absolute;
        inset: 0;
        z-index: 10;
        opacity: 0.03;
        pointer-events: none;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
    }

    /* Mesh Gradient Background */
    .mesh-gradient {
        background-color: var(--background);
        background-image: 
            radial-gradient(at 0% 0%, oklch(0.7 0.2 260 / 15%) 0px, transparent 50%),
            radial-gradient(at 100% 0%, oklch(0.6 0.2 300 / 15%) 0px, transparent 50%),
            radial-gradient(at 100% 100%, oklch(0.8 0.2 100 / 10%) 0px, transparent 50%),
            radial-gradient(at 0% 100%, oklch(0.5 0.2 200 / 15%) 0px, transparent 50%);
        background-attachment: fixed;
    }

    /*
      Crisp mode (scoped): prevents Windows text softening caused by
      GPU compositing + 3D transforms + overlay noise.
      Applied via the `ui-crisp` wrapper on /chat and /workflows.
    */
    .ui-crisp {
        text-rendering: geometricPrecision;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    .ui-crisp .noise::before {
        display: none;
    }

    .ui-crisp .card-3d,
    .ui-crisp .perspective-none,
    .ui-crisp .perspective-dramatic,
    .ui-crisp .perspective-near,
    .ui-crisp .perspective,
    .ui-crisp .perspective-distant,
    .ui-crisp .preserve-3d {
        perspective: none;
        transform-style: flat;
    }

    .ui-crisp .card-3d-inner,
    .ui-crisp .translate-z-0,
    .ui-crisp .translate-z-1,
    .ui-crisp .translate-z-2,
    .ui-crisp .translate-z-4,
    .ui-crisp .translate-z-8,
    .ui-crisp .-translate-z-1,
    .ui-crisp .-translate-z-2,
    .ui-crisp .rotate-x-0,
    .ui-crisp .rotate-x-1,
    .ui-crisp .rotate-x-2,
    .ui-crisp .rotate-x-3,
    .ui-crisp .rotate-x-6,
    .ui-crisp .rotate-x-12,
    .ui-crisp .-rotate-x-1,
    .ui-crisp .-rotate-x-2,
    .ui-crisp .-rotate-x-3,
    .ui-crisp .-rotate-x-6,
    .ui-crisp .rotate-y-0,
    .ui-crisp .rotate-y-1,
    .ui-crisp .rotate-y-2,
    .ui-crisp .rotate-y-3,
    .ui-crisp .rotate-y-6,
    .ui-crisp .rotate-y-12,
    .ui-crisp .-rotate-y-1,
    .ui-crisp .-rotate-y-2,
    .ui-crisp .-rotate-y-3,
    .ui-crisp .-rotate-y-6 {
        transform: none !important;
        filter: none;
    }
}

/* @starting-style for CSS-only enter animations */
@layer components {
    /* Dialog/Modal starting styles */
    [data-slot='dialog-overlay'] {
        transition:
            opacity 200ms var(--ease-smooth),
            display 200ms var(--ease-smooth);
        transition-behavior: allow-discrete;

        @starting-style {
            opacity: 0;
        }
    }

    [data-slot='dialog-content'] {
        transition:
            opacity 200ms var(--ease-smooth),
            transform 200ms var(--ease-spring),
            display 200ms var(--ease-smooth);
        transition-behavior: allow-discrete;

        @starting-style {
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.95);
        }
    }

    /* Dropdown/Popover starting styles */
    [data-slot='dropdown-menu-content'],
    [data-slot='popover-content'] {
        transition:
            opacity 150ms var(--ease-smooth),
            transform 150ms var(--ease-spring),
            display 150ms var(--ease-smooth);
        transition-behavior: allow-discrete;

        @starting-style {
            opacity: 0;
            transform: scale(0.95);
        }
    }

    /* Sheet/Drawer starting styles */
    [data-side='right'] {
        @starting-style {
            transform: translateX(100%);
        }
    }

    [data-side='left'] {
        @starting-style {
            transform: translateX(-100%);
        }
    }

    [data-side='top'] {
        @starting-style {
            transform: translateY(-100%);
        }
    }

    [data-side='bottom'] {
        @starting-style {
            transform: translateY(100%);
        }
    }

    /* Card 3D hover effect */
    .card-3d {
        perspective: var(--perspective-default);
        transform-style: preserve-3d;
    }

    .card-3d-inner {
        transition: transform 300ms var(--ease-spring);
        transform-style: preserve-3d;
    }

    .card-3d:hover .card-3d-inner {
        transform: rotateY(3deg) rotateX(-2deg) translateZ(10px);
    }

    /* Mobile menu animation */
    .mobile-menu {
        transition:
            transform 300ms var(--ease-smooth),
            opacity 300ms var(--ease-smooth),
            visibility 300ms;
        transition-behavior: allow-discrete;
    }

    .mobile-menu[data-state='closed'] {
        transform: translateX(100%);
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
    }

    .mobile-menu[data-state='open'] {
        transform: translateX(0);
        opacity: 1;
        visibility: visible;
        pointer-events: auto;

        @starting-style {
            transform: translateX(100%);
            opacity: 0;
        }
    }

    /* Backdrop blur animation */
    .backdrop-animate {
        transition:
            backdrop-filter 200ms var(--ease-smooth),
            opacity 200ms var(--ease-smooth);
    }

    /* Container query responsive card */
    .responsive-card {
        container-type: inline-size;
    }

    .responsive-card-content {
        @container (min-width: 20rem) {
            grid-template-columns: repeat(2, 1fr);
        }

        @container (min-width: 28rem) {
            grid-template-columns: repeat(3, 1fr);
        }
    }
}

@keyframes accordion-down {
    from {
        height: 0;
    }
    to {
        height: var(--radix-accordion-content-height);
    }
}

@keyframes accordion-up {
    from {
        height: var(--radix-accordion-content-height);
    }
    to {
        height: 0;
    }
}

.animate-accordion-down {
    animation: accordion-down 0.2s ease-out;
}

.animate-accordion-up {
    animation: accordion-up 0.2s ease-out;
}

/* Animated gradient keyframes */
@keyframes gradient-rotate {
    from {
        --gradient-angle: 0deg;
    }
    to {
        --gradient-angle: 360deg;
    }
}

/* Pulse glow effect */
@keyframes pulse-glow {
    0%,
    100% {
        box-shadow: 0 0 20px oklch(var(--primary) / 20%);
    }
    50% {
        box-shadow: 0 0 40px oklch(var(--primary) / 40%);
    }
}

.animate-pulse-glow {
    animation: pulse-glow 2s ease-in-out infinite;
}

/* Float animation */
@keyframes float {
    0%,
    100% {
        transform: translateY(0) rotateX(0);
    }
    50% {
        transform: translateY(-10px) rotateX(2deg);
    }
}

.animate-float {
    animation: float 3s ease-in-out infinite;
}

/* Shimmer effect for loading states */
@keyframes shimmer {
    0% {
        --gradient-position: -100%;
    }
    100% {
        --gradient-position: 200%;
    }
}

.animate-shimmer {
    animation: shimmer 2s linear infinite;
    background: linear-gradient(
        90deg,
        transparent 0%,
        oklch(var(--foreground) / 5%) var(--gradient-position),
        transparent 100%
    );
}
